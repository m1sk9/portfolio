---
layout: '../../../../organisms/BlogLayout.astro'
title: 'Misskey の脆弱性対処に関する問題点'
description: '珍しい真面目記事のクソデカお気持ち表明です (旧Blogからの移行記事)'
published: false
published_at: '2023-11-27'
---

この記事では, 2023/11/25 に Misskey の開発チームである misskey-dev が公開した プロトコル上で要求されるセキュリティの基礎的な検証が欠落していたこと に起因する脆弱性 GHSA-3f39-6537-3cgc について, その対処に関する問題点を指摘します.

## 脆弱性の概要

Misskey はリモートアクターが受信トレイに POST する資格があるかどうかを検証する必要がある場合, その HTTP メッセージ署名を検証するだけで済ませてしまい, 攻撃者は ActivityPub のサーバー間連携プロトコルを使用して任意のユーザーに成りすますことができる脆弱性が存在しています.

この脆弱性は `GHSA-3f39-6537-3cgc` として GitHub Security Advisory にて開示が行われています. 今回この脆弱性の対処に関していくつかの問題点があります. これらの問題は今後の Misskey の開発においても避けては通れない問題であるため, 今回の脆弱性対処を機に改善されることを期待します.

## 問題点

この脆弱性が実際に修正されたのは **2023/11/14 に行われたコミットハッシュ [`65c5626b65ee00d2663ec3604140a18427b65cdc`](https://github.com/misskey-dev/misskey/commit/65c5626b65ee00d2663ec3604140a18427b65cdc) のコミット** です. そして脆弱性が存在していることが実際に GitHub Security Advisory にて開示されたのは **2023/11/25** です. (syuilo氏が検証の必要性を1年前から認識していたのに今更の対応になったことについては別記事で散々言われていたことなので触れません.)

本来脆弱性というものは攻撃者が悪用するのを避けるために **GitHub Security Advisory / GitHub Advisory Database など適切な場で開示されることが望まれ, コミット情報などでこれらの脆弱性があったことを公開することは避けるべき**です. しかし今回の脆弱性対処に関してはコミット情報によって公開されてしまっています.

## 改善点

実際に修正されたコミットに対して, その脆弱性に関する情報を公開することは避けるべきです.

**脆弱性の情報は適切な場で公開し, その脆弱性が修正されたことはコミット情報などで公開するべきではありません.**

misskey-dev には今後発覚するであろう脆弱性に関しても適切な対応を行っていくことを期待します.
